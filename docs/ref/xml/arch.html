<!--$Id: arch.so,v 1.2 2003/05/02 18:34:45 merrells Exp $-->
<!--Copyright 1997-2003 by Sleepycat Software, Inc.-->
<!--All rights reserved.-->
<!--See the file LICENSE for redistribution information.-->
<html>
<head>
<title>Berkeley DB Reference Guide: Architecture</title>
<meta name="description" content="Berkeley DB: An embedded database programmatic toolkit.">
<meta name="keywords" content="embedded,database,programmatic,toolkit,b+tree,btree,hash,hashing,transaction,transactions,locking,logging,access method,access methods,Java,C,C++">
</head>
<body bgcolor=white>
<table width="100%"><tr valign=top>
<td><h3><dl><dt>Berkeley DB Reference Guide:<dd>Berkeley DB XML</dl></h3></td>
<td align=right><a href="../../ref/xml/intro.html"><img src="../../images/prev.gif" alt="Prev"></a><a href="../../reftoc.html"><img src="../../images/ref.gif" alt="Ref"></a><a href="../../ref/xml/documents.html"><img src="../../images/next.gif" alt="Next"></a>
</td></tr></table>
<p>
<h3 align=center>Architecture</h3>
<p>Berkeley DB XML is implemented as C++ library on top of Berkeley DB. Berkeley DB XML is
distributed as a shared library that is embedded into the client
application. The Berkeley DB XML library exposes API's that enable C++ and Java
applications to interact with the XML data containers. Figure 1
illustrates the Berkeley DB XML system architecture. </p>
<p align=center><img src="xml_fig_1.gif" alt="xml_fig_1">
<p>Berkeley DB XML uses Berkeley DB for data storage and transaction management.  Client
applications can also store data directly to a Berkeley DB database.  Although
Berkeley DB XML is implemented as a layer on top of Berkeley DB, some understanding of
the underlying Berkeley DB API is required, as some Berkeley DB XML API methods accept
Berkeley DB object handles as parameters.</p>
<p>The Berkeley DB XML library consists of three main components: a Document Storage
Manager, an XML Indexer, and a Query Processing Engine.</p>
<h3>Document Storage</h3>
<p>Within Berkeley DB XML, documents are stored in containers.  Each container has
a name, document store, data dictionary, and sets of indices and
system-maintained statistics. The client application can operate on
multiple containers concurrently, and controls the placement of
documents within containers.  The client application can also store data
to Berkeley DB databases. A client application can perform the following
actions against a container:</p>
<table border=1 align=center>
<tr><th>Action</th></tr>
<tr><td>Declare an index against the container.</td></tr>
<tr><td>Open the container for use within the application.</td></tr>
<tr><td>Insert a document into the container.</td></tr>
<tr><td>Retrieve a document from the container.</td></tr>
<tr><td>Update a document in the container.</td></tr>
<tr><td>Query the container using an XPath expression.</td></tr>
<tr><td>Delete a document from the container.</td></tr>
<tr><td>Close the container.</td></tr>
<tr><td>Rename the container.</td></tr>
<tr><td>Delete the container.</td></tr>
<tr><td>Dump the container to a text file.</td></tr>
<tr><td>Load the container from a text file that was generated by a container dump.</td></tr>
<tr><td>Verify that the container is internally consistent.</td></tr>
</table>
<p>The following code example demonstrates how to create a container,
insert a document into the container, retrieve the document, and display
the document contents.  Note that exception handling has been removed
for clarity.</p>
<blockquote><pre>void example()
{
	// Create and open a container called "test"
	XmlContainer container(0,"test.dbxml");
	container.open(0,DB_CREATE);
	XmlDocument document;
<p>
 	// Create an XML document and insert into the container
	std::string content("&lt;book&gt;&lt;title&gt;Databases&lt;/title&gt;&lt;/book&gt;");
	document.setContent(content);
	u_int32_t id= container.putDocument(0,document);
<p>
	// Retrieve the document and display the contents.
	document= container.getDocument(0,id);
	std::string s;
	std::cout &lt;&lt; id &lt;&lt; " = " &lt;&lt; document.getContentAsString(s) &lt;&lt; "\n";
	container.close();
}</pre></blockquote>
<table width="100%"><tr><td><br></td><td align=right><a href="../../ref/xml/intro.html"><img src="../../images/prev.gif" alt="Prev"></a><a href="../../reftoc.html"><img src="../../images/ref.gif" alt="Ref"></a><a href="../../ref/xml/documents.html"><img src="../../images/next.gif" alt="Next"></a>
</td></tr></table>
<p><font size=1><a href="../../sleepycat/legal.html">Copyright (c) 1996-2003</a> <a href="http://www.sleepycat.com">Sleepycat Software, Inc.</a> - All rights reserved.</font>
</body>
</html>
