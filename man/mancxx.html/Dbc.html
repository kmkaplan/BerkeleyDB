<HTML>
<HEAD>
<TITLE>Dbc</TITLE>
</HEAD>
<BODY>
<H1>Dbc</H1>
<HR>
<PRE>

</PRE>
<H2>NAME</H2><PRE>
       Dbc - database sequential access functions


</PRE>
<H2>SYNOPSIS</H2><PRE>
       <STRONG>#include</STRONG> <STRONG>&lt;db_cxx.h&gt;</STRONG>

       <STRONG>int</STRONG>
       <STRONG>Dbc::close(void);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>Dbc::del(int</STRONG> <STRONG>flags);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>Dbc::get(Dbt</STRONG> <STRONG>*key,</STRONG> <STRONG>Dbt</STRONG> <STRONG>*data,</STRONG> <STRONG>int</STRONG> <STRONG>flags);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>Dbc::put(Dbt</STRONG> <STRONG>*key,</STRONG> <STRONG>Dbt</STRONG> <STRONG>*data,</STRONG> <STRONG>int</STRONG> <STRONG>flags);</STRONG>


</PRE>
<H2>DESCRIPTION</H2><PRE>
       The DB library is a family of classes that provides a mod-
       ular programming interface to transactions and record-ori-
       ented  file  access.   The  library  includes  support for
       transactions, locking, logging and file page  caching,  as
       well  as  various  indexed  access  methods.   Many of the
       classes (e.g., the file page  caching  class)  are  useful
       independent of the other DB classes, although some classes
       are explicitly based on other classes (e.g.,  transactions
       and  logging).   For a general description of the DB pack-
       age, see <STRONG><A HREF="db_intro.html">db_intro(3)</A></STRONG>.

       This manual page describes the  specific  details  of  the
       cursor support for the access methods in <EM>Db(3)</EM>.

       The  <EM>Dbc</EM>  functions  are  the library interface supporting
       sequential access to the  records  stored  by  the  access
       methods of the Db library.  Cursors are created by calling
       <EM>Db::cursor</EM> method described  in  <STRONG><A HREF="Db.html">Db(3)</A></STRONG>,  which  returns  a
       pointer to a Dbc object.

       Each cursor maintains positioning information within a set
       of key/data pairs.  In the presence of transactions,  cur-
       sors  are only valid within the context of a single trans-
       action, the  one  specified  during  the  <EM>Db::cursor</EM>  call
       described  in  <STRONG><A HREF="Db.html">Db(3)</A></STRONG>.   All cursor operations will be exe-
       cuted in the context of that transaction.  Before aborting
       or  committing a transaction, all cursors used within that
       transaction must be closed.  In the presence  of  transac-
       tions,  the  application  must call <EM>DbTxn::abort</EM> if any of
       the cursor operations returns that a deadlock (EAGAIN)  or
       system failure occurred.

       When  locking  is enabled, page locks are retained between
       consecutive cursor calls.  For this reason, in  the  pres-
       ence  of  locking,  applications should discard cursors as
            returns  the  value of <EM>errno</EM> on failure and 0 on suc-
            cess.

       int Dbc::del(int flags);
            A method that deletes  the  key/data  pair  currently
            referenced by the cursor.

            The  <EM>flags</EM> parameter is currently unused, and must be
            set to 0.

            The cursor position is unchanged after a  delete  and
            subsequent  calls  to  cursor functions expecting the
            cursor to reference an existing key will fail.

            The  <EM>Dbc::del</EM>  method  throws  a  <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG>   or
            returns  the value of <EM>errno</EM> on failure, 0 on success,
            and DB_KEYEMPTY  if  the  element  has  already  been
            deleted.

       int Dbc::get(Dbt *key, Dbt *data, int flags);
            A  method  that  retrieves  key/data  pairs  from the
            database.  The address and  length  of  the  key  are
            returned  in the object referenced by <EM>key</EM> (except for
            the case of the DB_SET flag where the <EM>key</EM>  object  is
            unchanged),  and  the  address and length of the data
            are returned in the object referenced by <EM>data</EM>.

            Modifications to the  database  during  a  sequential
            scan  will  be  reflected  in  the scan, i.e. records
            inserted behind a cursor will not be  returned  while
            records  inserted  in  front  of  a  cursor  will  be
            returned.

            In recno databases, missing  entries  (i.e.,  entries
            that  were never explicitly created or that were cre-
            ated and then deleted),  will  be  skipped  during  a
            sequential scan.

            If  multiple  threads  or processes insert items into
            the same database file  without  using  locking,  the
            results are undefined.  For more detail, see the sec-
            tion below on cursor stability.

            The parameter <EM>flags</EM> must be set to exactly one of the
            following values:

            DB_FIRST
                 The   cursor  is  set  to  reference  the  first
                 key/data pair of the database, and that pair  is
                 returned.  In the presence of duplicate key val-
                 ues, the first data item in the  set  of  dupli-
                 cates is returned.

                 If  the  database  is empty, the <EM>Dbc::get</EM> method

            DB_NEXT
                 If the cursor is not yet initialized, DB_NEXT is
                 identical to DB_FIRST.

                 Otherwise, move the cursor to the next  key/data
                 pair of the database, and that pair is returned.
                 In the presence of duplicate key values, the key
                 may not change.

                 If  the  cursor is already on the last record in
                 the database, the <EM>Dbc::get</EM>  method  will  return
                 DB_NOTFOUND.

            DB_PREV
                 If the cursor is not yet initialized, DB_PREV is
                 identical to DB_LAST.

                 Otherwise,  move  the  cursor  to  the  previous
                 key/data  pair of the database, and that pair is
                 returned.  In the presence of duplicate key val-
                 ues, the key may not change.

                 If  the cursor is already on the first record in
                 the database, the <EM>Dbc::get</EM>  method  will  return
                 DB_NOTFOUND.

            DB_CURRENT
                 Return the key/data pair currently referenced by
                 the cursor.

                 If the cursor key/data pair  has  been  deleted,
                 the <EM>Dbc::get</EM> method will return DB_KEYEMPTY.

                 If  the  cursor  is  not  yet  initialized,  the
                 <EM>Dbc::get</EM> method will return EINVAL.

            DB_SET
                 Move the cursor to the specified  key/data  pair
                 of the database, and return the datum associated
                 with the given key.

                 In  the  presence  of  duplicate   key   values,
                 <EM>Dbc::get</EM> will return the first data item for the
                 given key.

                 If the database is  a  recno  database  and  the
                 requested  key  exists, but was never explicitly
                 created by the application or was later deleted,
                 the <EM>Dbc::get</EM> method returns DB_KEYEMPTY.

                 If  no  matching  keys  are  found, the <EM>Dbc::get</EM>
                 method will return DB_NOTFOUND.

            DB_SET_RANGE
                 <EM>key</EM>  must be a pointer to a memory location from
                 which a <EM>db</EM><STRONG>_</STRONG><EM>recno</EM><STRONG>_</STRONG><EM>t</EM> may be read, as described  in
                 <STRONG><A HREF="Dbt.html">Dbt(3)</A></STRONG>.   This  memory  location will be read to
                 determine the record to be retrieved.

                 For DB_SET_RECNO to be specified, the underlying
                 database  must be of type btree and it must have
                 been  created  with  the  DB_RECNUM  flag   (see
                 <EM>Db::open</EM> in <STRONG><A HREF="Db.html">Db(3)</A></STRONG>).

            DB_GET_RECNO
                 Return  the  record  number  associated with the
                 cursor.  The record number will be  returned  in
                 the  data  Dbt  as described in <STRONG><A HREF="Dbt.html">Dbt(3)</A></STRONG>.  The <EM>key</EM>
                 parameter is ignored.

                 For DB_GET_RECNO to be specified, the underlying
                 database  must be of type btree and it must have
                 been  created  with  the  DB_RECNUM  flag   (see
                 <EM>Db::open</EM> in <STRONG><A HREF="Db.html">Db(3)</A></STRONG>).

            Otherwise,  the  <EM>Dbc::get</EM>  method  throws  a <EM>DbExcep-</EM>
            <STRONG><A HREF="tion.html">tion(3)</A></STRONG> or returns the value of <EM>errno</EM> on failure  and
            0 on success.

            If  <EM>Dbc::get</EM>  fails  for any reason, the state of the
            cursor will be unchanged.

       int Dbc::put(Dbt *key, Dbt *data, int flags);
            A  method  that  stores  key/data  pairs   into   the
            database.

            The <EM>flags</EM> parameter must be set to exactly one of the
            following values:

            DB_AFTER
                 In the case of the btree and hash  access  meth-
                 ods, insert the data element as a duplicate ele-
                 ment of the key referenced by the  cursor.   The
                 new  element  appears immediately after the cur-
                 rent cursor position.  It is an error to specify
                 DB_AFTER   if   the  underlying  btree  or  hash
                 database was not created with the  DB_DUP  flag.
                 The <EM>key</EM> parameter is ignored.

                 In the case of the recno access method, it is an
                 error to  specify  DB_AFTER  if  the  underlying
                 recno   database   was   not  created  with  the
                 DB_RENUMBER flag.  If the DB_RENUMBER  flag  was
                 specified,  a  new  key  is created, all records
                 after the inserted item are automatically renum-
                 bered, and the key of the new record is returned
                 in the object referenced by the  parameter  <EM>key</EM>.
                 The  initial  value  of  the  <EM>key</EM>  parameter  is
                 DB_BEFORE   if  the  underlying  btree  or  hash
                 database was not created with the  DB_DUP  flag.
                 The <EM>key</EM> parameter is ignored.

                 In the case of the recno access method, it is an
                 error to specify  DB_BEFORE  if  the  underlying
                 recno   database   was   not  created  with  the
                 DB_RENUMBER flag.  If the DB_RENUMBER  flag  was
                 specified,  a  new  key  is created, the current
                 record and all records after  it  are  automati-
                 cally  renumbered, and the key of the new record
                 is returned in  the  object  referenced  by  the
                 parameter  <EM>key</EM>.   The  initial  value of the <EM>key</EM>
                 parameter is ignored.  See <EM>Db::open</EM> in <STRONG><A HREF="Db.html">Db(3)</A></STRONG> for
                 more information.

                 If  the  cursor  is  not  yet  initialized,  the
                 <EM>Dbc::put</EM> method will return EINVAL.

            DB_CURRENT
                 Overwrite the data of the key/data  pair  refer-
                 enced  by  the  cursor  with  the specified data
                 item.

                 The <EM>key</EM> parameter is ignored.

                 If  the  cursor  is  not  yet  initialized,  the
                 <EM>Dbc::put</EM> method will return EINVAL.

            DB_KEYFIRST
                 In  the  case of the btree and hash access meth-
                 ods, insert the specified key/data pair into the
                 database.   If  the  key  already  exists in the
                 database, the inserted data item is added as the
                 first of the data items for that key.

                 The DB_KEYFIRST flag may not be specified to the
                 recno access method.

            DB_KEYLAST
                 Insert the  specified  key/data  pair  into  the
                 database.   If  the  key  already  exists in the
                 database, the inserted data item is added as the
                 last of the data items for that key.

                 The  DB_KEYLAST flag may not be specified to the
                 recno access method.

            If the cursor record has been deleted,  the  <EM>Dbc::put</EM>
            method will return DB_KEYEMPTY.

            Otherwise,  the  <EM>Dbc::put</EM>  method  throws  a <EM>DbExcep-</EM>
            <STRONG><A HREF="tion.html">tion(3)</A></STRONG> or returns the value of <EM>errno</EM> on failure  and
            0 on success.

       cursor or non-cursor operations in the same thread of con-
       trol  (i.e.,  thread  or  single-threaded  process),  will
       always  return  keys  in  order  and will return each non-
       deleted key/data pair  exactly  once.   Because  the  hash
       access  method uses a dynamic hashing algorithm, it cannot
       guarantee any form of stability in the presence of inserts
       and deletes unless locking is performed.

       If  locking was specified when the Db file was opened, but
       transactions are not in effect, the access methods provide
       repeatable  reads  with respect to the cursor.  That is, a
       DB_CURRENT call on the cursor is guaranteed to return  the
       same  record  as was returned on the last call to the cur-
       sor.

       In the presence of transactions, the access  method  calls
       between  <EM>DbTxnMgr::begin</EM> and <EM>DbTxn::abort</EM> or <EM>DbTxn::commit</EM>
       provide degree 3 consistency.  For all access  methods,  a
       cursor  scan  of the database performed within the context
       of a transaction is guaranteed  to  return  each  key/data
       pair  once  and  only  once, except in the following case.
       If, while performing a cursor scan using the  hash  access
       method,  the transaction performing the scan inserts a new
       pair into the database,  it  is  possible  that  duplicate
       key/data pairs will be returned.


</PRE>
<H2>ERRORS</H2><PRE>
       Methods  marked as returning <EM>errno</EM> will, by default, throw
       an exception that encapsulates the error information.  The
       default error behavior can be changed, see <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG>.

       The <EM>Dbc::close</EM> method may fail and throw a  <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG>
       or  return  <EM>errno</EM>  for any of the errors specified for the
       following DB and library functions: DbLock::<STRONG><A HREF="get.html">get(3)</A></STRONG>,
       DbLock::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbLockTab::<STRONG><A HREF="id.html">id(3)</A></STRONG>, DbLockTab::<STRONG><A HREF="vec.html">vec(3)</A></STRONG>,
       DbLog::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbMpoolFile::<STRONG><A HREF="get.html">get(3)</A></STRONG>, DbMpoolFile::<STRONG><A HREF="put.html">put(3)</A></STRONG>,
       DbMpoolFile::<STRONG><A HREF="set.html">set(3)</A></STRONG>, <STRONG><A HREF="calloc.html">calloc(3)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>,
       <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memmove.html">memmove(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="realloc.html">realloc(3)</A></STRONG>,
       and <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>.

       In  addition,  the  <EM>Dbc::close</EM> method may fail and throw a
       <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG> or return <EM>errno</EM> for  the  following  condi-
       tions:

       [EAGAIN]
            A lock was unavailable.

       [EPERM]
            Database  corruption  was  detected.   All subsequent
            database calls (other  than  <EM>Db::close</EM>)  will  return
            EPERM.

       The <EM>Dbc::del</EM> method may fail and throw a <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG> or
       return <EM>errno</EM> for any of the errors specified for the  fol-
            A lock was unavailable.

       [EINVAL]
            An invalid flag value or parameter was specified.

       [EPERM]
            Database corruption  was  detected.   All  subsequent
            database  calls  (other  than  <EM>Db::close</EM>) will return
            EPERM.

       The <EM>Dbc::get</EM> method may fail and throw a <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG> or
       return  <EM>errno</EM> for any of the errors specified for the fol-
       lowing DB and library functions: Db::<STRONG><A HREF="get.html">get(3)</A></STRONG>,
       DbLock::<STRONG><A HREF="get.html">get(3)</A></STRONG>, DbLock::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbLockTab::<STRONG><A HREF="id.html">id(3)</A></STRONG>,
       DbLockTab::<STRONG><A HREF="vec.html">vec(3)</A></STRONG>, DbLog::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbMpoolFile::<STRONG><A HREF="get.html">get(3)</A></STRONG>,
       DbMpoolFile::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbMpoolFile::<STRONG><A HREF="set.html">set(3)</A></STRONG>, <STRONG><A HREF="calloc.html">calloc(3)</A></STRONG>,
       <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcmp.html">memcmp(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>,
       <STRONG><A HREF="memmove.html">memmove(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="realloc.html">realloc(3)</A></STRONG>, and <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>.

       In  addition,  the  <EM>Dbc::get</EM>  method  may fail and throw a
       <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG> or return <EM>errno</EM> for  the  following  condi-
       tions:

       [EAGAIN]
            A lock was unavailable.

       [EINVAL]
            An invalid flag value or parameter was specified.

            The  DB_THREAD  flag  was  specified  to the <EM>Db::open</EM>
            method described in <STRONG><A HREF="Db.html">Db(3)</A></STRONG> and neither the DB_DBT_MAL-
            LOC or DB_DBT_USERMEM flags were set in the Dbt.

       [EPERM]
            Database  corruption  was  detected.   All subsequent
            database calls (other  than  <EM>Db::close</EM>)  will  return
            EPERM.

       The <EM>Dbc::put</EM> method may fail and throw a <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG> or
       return <EM>errno</EM> for any of the errors specified for the  fol-
       lowing DB and library functions: DbLock::<STRONG><A HREF="get.html">get(3)</A></STRONG>,
       DbLock::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbLockTab::<STRONG><A HREF="id.html">id(3)</A></STRONG>, DbLockTab::<STRONG><A HREF="vec.html">vec(3)</A></STRONG>,
       DbLog::<STRONG><A HREF="put.html">put(3)</A></STRONG>, DbMpoolFile::<STRONG><A HREF="get.html">get(3)</A></STRONG>, DbMpoolFile::<STRONG><A HREF="put.html">put(3)</A></STRONG>,
       DbMpoolFile::<STRONG><A HREF="set.html">set(3)</A></STRONG>, <STRONG><A HREF="calloc.html">calloc(3)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>,
       <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcmp.html">memcmp(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memmove.html">memmove(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>,
       <STRONG><A HREF="realloc.html">realloc(3)</A></STRONG>, and <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>.

       In addition, the <EM>Dbc::put</EM> method  may  fail  and  throw  a
       <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG>  or  return  <EM>errno</EM> for the following condi-
       tions:

       [EACCES]
            An attempt was made to modify a read-only database.

       <STRONG><A HREF="db_archive.html">db_archive(1)</A></STRONG>, <STRONG><A HREF="db_checkpoint.html">db_checkpoint(1)</A></STRONG>, <STRONG><A HREF="db_deadlock.html">db_deadlock(1)</A></STRONG>, <STRONG><A HREF="db_dump.html">db_dump(1)</A></STRONG>,
       <STRONG><A HREF="db_load.html">db_load(1)</A></STRONG>, <STRONG><A HREF="db_recover.html">db_recover(1)</A></STRONG>, <STRONG><A HREF="db_stat.html">db_stat(1)</A></STRONG>, <STRONG><A HREF="db_intro.html">db_intro(3)</A></STRONG>, <STRONG><A HREF="db_jump.html">db_jump(3)</A></STRONG>,
       <STRONG><A HREF="db_thread.html">db_thread(3)</A></STRONG>, <STRONG><A HREF="Db.html">Db(3)</A></STRONG>, <STRONG><A HREF="Dbc.html">Dbc(3)</A></STRONG>, <STRONG><A HREF="DbEnv.html">DbEnv(3)</A></STRONG>, <STRONG><A HREF="DbException.html">DbException(3)</A></STRONG>, <STRONG><A HREF="DbInfo.html">DbInfo(3)</A></STRONG>,
       <STRONG><A HREF="DbLock.html">DbLock(3)</A></STRONG>, <STRONG><A HREF="DbLocktab.html">DbLocktab(3)</A></STRONG>, <STRONG><A HREF="DbLog.html">DbLog(3)</A></STRONG>, <STRONG><A HREF="DbLsn.html">DbLsn(3)</A></STRONG>, <STRONG><A HREF="DbMpool.html">DbMpool(3)</A></STRONG>,
       <STRONG><A HREF="DbMpoolFile.html">DbMpoolFile(3)</A></STRONG>, <STRONG><A HREF="Dbt.html">Dbt(3)</A></STRONG>, <STRONG><A HREF="DbTxn.html">DbTxn(3)</A></STRONG>, <STRONG><A HREF="DbTxnMgr.html">DbTxnMgr(3)</A></STRONG>
</PRE>
</BODY>
</HTML>
