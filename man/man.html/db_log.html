<HTML>
<HEAD>
<TITLE>db_log</TITLE>
</HEAD>
<BODY>
<H1>db_log</H1>
<HR>
<PRE>

</PRE>
<H2>NAME</H2><PRE>
       db_log - log management functions


</PRE>
<H2>SYNOPSIS</H2><PRE>
       <STRONG>#include</STRONG> <STRONG>&lt;db.h&gt;</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_open(const</STRONG> <STRONG>char</STRONG> <STRONG>*dir,</STRONG>
            <STRONG>int</STRONG> <STRONG>flags,</STRONG> <STRONG>int</STRONG> <STRONG>mode,</STRONG> <STRONG>DB_ENV</STRONG> <STRONG>*dbenv,</STRONG> <STRONG>DB_LOG</STRONG> <STRONG>**regionp);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_close(DB_LOG</STRONG> <STRONG>*logp);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_flush(DB_LOG</STRONG> <STRONG>*logp,</STRONG> <STRONG>const</STRONG> <STRONG>DB_LSN</STRONG> <STRONG>*lsn);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_get(DB_LOG</STRONG> <STRONG>*logp,</STRONG> <STRONG>DB_LSN</STRONG> <STRONG>*lsn,</STRONG> <STRONG>DBT</STRONG> <STRONG>*data,</STRONG> <STRONG>int</STRONG> <STRONG>flags);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_compare(const</STRONG> <STRONG>DB_LSN</STRONG> <STRONG>*lsn0,</STRONG> <STRONG>const</STRONG> <STRONG>DB_LSN</STRONG> <STRONG>*lsn1);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_file(DB_LOG</STRONG> <STRONG>*logp,</STRONG> <STRONG>const</STRONG> <STRONG>DB_LSN</STRONG> <STRONG>*lsn,</STRONG> <STRONG>char</STRONG> <STRONG>*namep,</STRONG> <STRONG>size_t</STRONG> <STRONG>len);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_put(DB_LOG</STRONG> <STRONG>*logp,</STRONG> <STRONG>DB_LSN</STRONG> <STRONG>*lsn,</STRONG> <STRONG>const</STRONG> <STRONG>DBT</STRONG> <STRONG>*data,</STRONG> <STRONG>int</STRONG> <STRONG>flags);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_unlink(const</STRONG> <STRONG>char</STRONG> <STRONG>*dir,</STRONG> <STRONG>int</STRONG> <STRONG>force,</STRONG> <STRONG>DB_ENV</STRONG> <STRONG>*);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_archive(DB_LOG</STRONG> <STRONG>*logp,</STRONG>
            <STRONG>char</STRONG> <STRONG>**list[],</STRONG> <STRONG>int</STRONG> <STRONG>flags,</STRONG> <STRONG>void</STRONG> <STRONG>*(*db_malloc)(size_t));</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_register(DB_LOG</STRONG> <STRONG>*logp,</STRONG>
            <STRONG>const</STRONG> <STRONG>DB</STRONG> <STRONG>*dbp,</STRONG> <STRONG>const</STRONG> <STRONG>char</STRONG> <STRONG>*name,</STRONG> <STRONG>DBTYPE</STRONG> <STRONG>type,</STRONG> <STRONG>u_int32_t</STRONG> <STRONG>*fidp);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_unregister(DB_LOG</STRONG> <STRONG>*logp,</STRONG> <STRONG>u_int32_t</STRONG> <STRONG>fid);</STRONG>

       <STRONG>int</STRONG>
       <STRONG>log_stat(DB_LOG</STRONG> <STRONG>*logp,</STRONG> <STRONG>DB_LOG_STAT</STRONG> <STRONG>**spp,</STRONG> <STRONG>void</STRONG> <STRONG>*(*db_malloc)(size_t));</STRONG>


</PRE>
<H2>DESCRIPTION</H2><PRE>
       The  DB  library  is  a family of groups of functions that
       provides a modular programming interface  to  transactions
       and  record-oriented  file  access.   The library includes
       support for transactions, locking, logging and  file  page
       caching,  as well as various indexed access methods.  Many
       of the functional groups  (e.g.,  the  file  page  caching
       functions)  are  useful  independent of the other DB func-
       tions, although  some  functional  groups  are  explicitly
       taining  a  set  of  files.  The log is a record-oriented,
       append-only file, with records identified and accessed via
       <EM>DB</EM><STRONG>_</STRONG><EM>LSN</EM>'s (database log sequence numbers).

       DB_LSN's  are returned on each <EM>log</EM><STRONG>_</STRONG><EM>put</EM> operation, and only
       those DB_LSN's returned by <EM>log</EM><STRONG>_</STRONG><EM>put</EM> can later  be  used  to
       retrieve records from the log.

  <EM>log</EM><STRONG>_</STRONG><EM>open</EM>
       The <EM>log</EM><STRONG>_</STRONG><EM>open</EM> function copies a pointer, to the log identi-
       fied by the <STRONG>directory</STRONG> <EM>dir</EM>, into the memory location refer-
       enced by <EM>regionp</EM>.

       If  the  <EM>dbenv</EM>  argument to <EM>log</EM><STRONG>_</STRONG><EM>open</EM> was initialized using
       <EM>db</EM><STRONG>_</STRONG><EM>appinit</EM>,   <EM>dir</EM>   is   interpreted   as   described   by
       <STRONG><A HREF="db_appinit.html">db_appinit(3)</A></STRONG>.

       Otherwise,  if <EM>dir</EM> is not NULL, it is interpreted relative
       to the current working directory of the process.   If  <EM>dir</EM>
       is  NULL,  the following environment variables are checked
       in order: ``TMPDIR'', ``TEMP'', and ``TMP''.   If  one  of
       them  is set, log files are created relative to the direc-
       tory it specifies.  If none of them  are  set,  the  first
       possible   one  of  the  following  directories  is  used:
       <EM>/var/tmp</EM>, <EM>/usr/tmp</EM>, <EM>/temp</EM>, <EM>/tmp</EM>, <EM>C:/temp</EM> and <EM>C:/tmp</EM>.

       All files associated with the  log  are  created  in  this
       directory.   This  directory  must  already  exist when <EM>is</EM>
       <EM>called.</EM>  If the log already exists, the process must  have
       permission  to  read and write the existing files.  If the
       log does not already exist, it is optionally  created  and
       initialized.

       If  the  log  region  is  being  created and log files are
       already present, the log files are ``recovered'' and  sub-
       sequent log writes are appended to the end of the log.

       The  log  is  stored in one or more files in the specified
       directory.  Each file is named using the format

            log.NNNNN

       where ``NNNNN'' is the sequence number of the file  within
       the log.

       The  <EM>flags</EM>  and  <EM>mode</EM>  arguments specify how files will be
       opened and/or created when they don't already exist.   The
       flags value is specified by <STRONG>or</STRONG>'ing together one or more of
       the following values:

       DB_CREATE
            Create any underlying files, as  necessary.   If  the
            files  do not already exist and the DB_CREATE flag is
            not specified, the call will fail.

       The logging subsystem is configured  based  on  the  <EM>dbenv</EM>
       argument to <EM>log</EM><STRONG>_</STRONG><EM>open</EM>, which is a pointer to a structure of
       type DB_ENV (typedef'd in &lt;db.h&gt;).  It  is  expected  that
       applications  will  use  a  single DB_ENV structure as the
       argument to all of the subsystems in the DB  package.   In
       order  to ensure compatibility with future releases of DB,
       all fields of the DB_ENV structure that are not explicitly
       set  should  be initialized to 0 before the first time the
       structure is used.  Do this  by  declaring  the  structure
       external  or  static,  or by calling the C library routine
       <STRONG><A HREF="bzero.html">bzero(3)</A></STRONG> or <STRONG><A HREF="memset.html">memset(3)</A></STRONG>.

       The fields of the DB_ENV structure used  by  <EM>log</EM><STRONG>_</STRONG><EM>open</EM>  are
       described  below.   As  references to the DB_ENV structure
       may be maintained by <EM>log</EM><STRONG>_</STRONG><EM>open</EM>, it is  necessary  that  the
       DB_ENV  structure  and memory it references be valid until
       the <EM>log</EM><STRONG>_</STRONG><EM>close</EM> function is called.  If <EM>dbenv</EM> is NULL or any
       of  its  fields are set to 0, defaults appropriate for the
       system are used where possible.

       The following fields in the DB_ENV structure may  be  ini-
       tialized before calling <EM>log</EM><STRONG>_</STRONG><EM>open</EM>:


       void *(*db_errcall)(char *db_errpfx, char *buffer);
       FILE *db_errfile;
       const char *db_errpfx;
       int db_verbose;
            The  error  fields  of the DB_ENV behave as described
            for <STRONG><A HREF="db_appinit.html">db_appinit(3)</A></STRONG>.

       u_int32_t lg_max;
            The maximum  size  of  a  single  file  in  the  log.
            Because  DB_LSN file offsets are unsigned 4-byte val-
            ues, <EM>lg</EM><STRONG>_</STRONG><EM>max</EM>  may  not  be  larger  than  the  maximum
            unsigned 4-byte value.

            If <EM>lg</EM><STRONG>_</STRONG><EM>max</EM> is 0, a default value is used.

       The  <EM>log</EM><STRONG>_</STRONG><EM>open</EM> function returns the value of <EM>errno</EM> on fail-
       ure and 0 on success.

  <EM>log</EM><STRONG>_</STRONG><EM>close</EM>
       The <EM>log</EM><STRONG>_</STRONG><EM>close</EM> function closes the  log  specified  by  the
       <EM>logp</EM> argument.

       In  addition, if the <EM>dir</EM> argument to <EM>log</EM><STRONG>_</STRONG><EM>open</EM> was NULL and
       <EM>dbenv</EM> was not initialized using <EM>db</EM><STRONG>_</STRONG><EM>appinit</EM>, all files cre-
       ated  for  this  shared  region  will  be  removed,  as if
       <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM> were called.

       When multiple threads are using the DB_LOG handle  concur-
       rently,  only a single thread may call the <EM>log</EM><STRONG>_</STRONG><EM>close</EM> func-
       ure and 0 on success.

  <EM>log</EM><STRONG>_</STRONG><EM>get</EM>
       The  <EM>log</EM><STRONG>_</STRONG><EM>get</EM>  function  implements  a cursor inside of the
       log, retrieving records from the log according to the  <EM>lsn</EM>
       and <EM>flags</EM> parameters.

       The  data field of the <EM>data</EM> structure is set to the record
       retrieved and the size field indicates the number of bytes
       in  the  record.  See <STRONG><A HREF="db_dbt.html">db_dbt(3)</A></STRONG> for a description of other
       fields in the <EM>data</EM> structure.  <STRONG>When</STRONG> <STRONG>multiple</STRONG>  <STRONG>threads</STRONG>  <STRONG>are</STRONG>
       <STRONG>using</STRONG>  <STRONG>the</STRONG> <STRONG>returned</STRONG> <STRONG>DB_LOG</STRONG> <STRONG>handle</STRONG> <STRONG>concurrently,</STRONG> <STRONG>either</STRONG> <STRONG>the</STRONG>
       <STRONG>DB_DBT_MALLOC</STRONG> <STRONG>or</STRONG> <STRONG>DB_DBT_USERMEM</STRONG> <STRONG>flags</STRONG>  <STRONG>must</STRONG>  <STRONG>be</STRONG>  <STRONG>specified</STRONG>
       <STRONG>for</STRONG> <STRONG>any</STRONG> <STRONG>DBT</STRONG> <STRONG>used</STRONG> <STRONG>for</STRONG> <STRONG>data</STRONG> <STRONG>retrieval.</STRONG>

       The <EM>flags</EM> parameter must be set to exactly one of the fol-
       lowing values:

       DB_CHECKPOINT
            The last record written with the  DB_CHECKPOINT  flag
            specified  to the <EM>log</EM><STRONG>_</STRONG><EM>put</EM> function is returned in the
            <EM>data</EM> argument.  The <EM>lsn</EM> argument is overwritten  with
            the  DB_LSN of the record returned.  If no record has
            been previously written with the  DB_CHECKPOINT  flag
            specified, the first record in the log is returned.

            If  the log is empty the <EM>log</EM><STRONG>_</STRONG><EM>get</EM> function will return
            DB_NOTFOUND.

       DB_FIRST
            The first record from any of the log files  found  in
            the  log  directory is returned in the <EM>data</EM> argument.
            The <EM>lsn</EM> argument is overwritten with  the  DB_LSN  of
            the record returned.

            If  the log is empty the <EM>log</EM><STRONG>_</STRONG><EM>get</EM> function will return
            DB_NOTFOUND.

       DB_LAST
            The last record in the log is returned  in  the  <EM>data</EM>
            argument.   The  <EM>lsn</EM> argument is overwritten with the
            DB_LSN of the record returned.

            If the log is empty, the <EM>log</EM><STRONG>_</STRONG><EM>get</EM> function will return
            DB_NOTFOUND.

       DB_NEXT
            The  current  log  position  is  advanced to the next
            record in the log and that record is returned in  the
            <EM>data</EM>  argument.  The <EM>lsn</EM> argument is overwritten with
            the DB_LSN of the record returned.

            If the pointer has not been initialized via DB_FIRST,
            DB_LAST,  DB_SET,  DB_NEXT,  or DB_PREV, <EM>log</EM><STRONG>_</STRONG><EM>get</EM> will
            the DB_LSN of the record returned.

            If the pointer has not been initialized via DB_FIRST,
            DB_LAST, DB_SET, DB_NEXT, or  DB_PREV,  <EM>log</EM><STRONG>_</STRONG><EM>get</EM>  will
            return  the last record in the log.  If the first log
            record has already been returned or the log is empty,
            the <EM>log</EM><STRONG>_</STRONG><EM>get</EM> function will return DB_NOTFOUND.

            If  the  log  was opened with the DB_THREAD flag set,
            calls to <EM>log</EM><STRONG>_</STRONG><EM>get</EM>  with  the  DB_PREV  flag  set  will
            return EINVAL.

       DB_CURRENT
            Return  the  log  record  currently referenced by the
            log.

            If the log  pointer  has  not  been  initialized  via
            DB_FIRST, DB_LAST, DB_SET, DB_NEXT, or DB_PREV, or if
            the log was  opened  with  the  DB_THREAD  flag  set,
            <EM>log</EM><STRONG>_</STRONG><EM>get</EM> will return EINVAL.

       DB_SET
            Retrieve  the  record  specified by the <EM>lsn</EM> argument.
            If the specified DB_LSN is invalid  (e.g.,  does  not
            appear in the log) <EM>log</EM><STRONG>_</STRONG><EM>get</EM> will return EINVAL.

       Otherwise, the <EM>log</EM><STRONG>_</STRONG><EM>get</EM> function returns the value of <EM>errno</EM>
       on failure and 0 on success.

  <EM>log</EM><STRONG>_</STRONG><EM>compare</EM>
       The <EM>log</EM><STRONG>_</STRONG><EM>compare</EM> function allows the caller to compare  two
       DB_LSN's.   <EM>Log</EM><STRONG>_</STRONG><EM>compare</EM>  returns 0 if the two DB_LSN's are
       equal, 1 if <EM>lsn0</EM> is greater than <EM>lsn1</EM>, and -1 if  <EM>lsn0</EM>  is
       less than <EM>lsn1</EM>.

  <EM>log</EM><STRONG>_</STRONG><EM>file</EM>
       The  <EM>log</EM><STRONG>_</STRONG><EM>file</EM>  function  maps DB_LSN's to file names.  The
       <EM>log</EM><STRONG>_</STRONG><EM>file</EM> function copies the name of the  file  containing
       the  record  named  by <EM>lsn</EM> into the memory location refer-
       enced by <EM>namep</EM>.  (This mapping of DB_LSN to file is needed
       for  database  administration.  For example, a transaction
       manager typically records the earliest DB_LSN  needed  for
       restart,  and  the  database  administrator  may  want  to
       archive log files to tape when they contain only  DB_LSN's
       before the earliest one needed for restart.)

       The  <EM>len</EM>  argument  is  the  length of the <EM>namep</EM> buffer in
       bytes.  If <EM>namep</EM> is too  short  to  hold  the  file  name,
       <EM>log</EM><STRONG>_</STRONG><EM>file</EM>  will  return  ENOMEM.  Note, as described above,
       log file names are quite short, on the order of 10 charac-
       ters.

       The  <EM>log</EM><STRONG>_</STRONG><EM>file</EM> function returns the value of <EM>errno</EM> on fail-
       ure and 0 on success.
            The  log is forced to disk after this record is writ-
            ten, guaranteeing that all records with DB_LSNs  less
            than or equal to the one being put are on disk before
            this function returns (this function  is  most  often
            used for a transaction commit, see <STRONG><A HREF="db_txn.html">db_txn(3)</A></STRONG>).

       The  caller  is  responsible  for  providing any necessary
       structure to <EM>data</EM>.  (For example, in a write-ahead logging
       protocol,  the  application  must  understand what part of
       <EM>data</EM> is an operation code, what part is redo  information,
       and  what  part  is  undo  information.  In addition, most
       transaction managers will store in <EM>data</EM> the DB_LSN of  the
       previous  log  record for the same transaction, to support
       chaining back through the transaction's log records during
       undo.)

       The <EM>log</EM><STRONG>_</STRONG><EM>put</EM> function returns the value of <EM>errno</EM> on failure
       and 0 on success.


  <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM>
       The <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM> function destroys the log region identified
       by the directory <EM>dir</EM>, removing all files used to implement
       the log region.  (The log files themselves and the  direc-
       tory  <EM>dir</EM>  are  not removed.)  If there are processes that
       have called  <EM>log</EM><STRONG>_</STRONG><EM>open</EM>  without  calling  <EM>log</EM><STRONG>_</STRONG><EM>close</EM>  (i.e.,
       there  are  processes  currently  using  the  log region),
       <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM> will fail without further  action,  unless  the
       force  flag  is set, in which case <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM> will attempt
       to remove the log region files regardless of any processes
       still using the log region.

       The  result  of  attempting to forcibly destroy the region
       when a process has the region open is  unspecified.   Pro-
       cesses  using a shared memory region maintain an open file
       descriptor for it.  On UNIX systems,  the  region  removal
       should  succeed and processes that have already joined the
       region should  continue  to  run  in  the  region  without
       change,  however  processes  attempting  to  join  the log
       region will either fail or attempt to create a new region.
       On  other  systems,  e.g., WNT, where the <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG> system
       call will fail if any process has an open file  descriptor
       for the file, the region removal will fail.

       In  the  case  of catastrophic or system failure, database
       recovery must be  performed  (see  <STRONG><A HREF="db_recovery.html">db_recovery(1)</A></STRONG>  or  the
       DB_RECOVER  flags  to  <STRONG><A HREF="db_appinit.html">db_appinit(3)</A></STRONG>).   Alternatively, if
       recovery is not required  because  no  database  state  is
       maintained  across  failures, it is possible to clean up a
       log region by removing all of the files in  the  directory
       specified  to  the  <EM>log</EM><STRONG>_</STRONG><EM>open</EM> function, as log region files
       are never created in any  directory  other  than  the  one
       specified  to  <EM>log</EM><STRONG>_</STRONG><EM>open</EM>.  Note, however, that this has the
       potential to remove files created by the other DB  subsys-
       involved in active transactions), and that may be archived
       for  catastrophic  recovery and then removed from the sys-
       tem.  If there were no file names to return, <EM>list</EM> will  be
       set to NULL.

       Arrays  of log file names are created in allocated memory.
       If <EM>db</EM><STRONG>_</STRONG><EM>malloc</EM> is non-NULL, it is  called  to  allocate  the
       memory, otherwise, the library function <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG> is used.
       The function <EM>db</EM><STRONG>_</STRONG><EM>malloc</EM> must match the calling  conventions
       of  the <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG> library routine.  Regardless, the caller
       is responsible for deallocating the returned  memory.   To
       deallocate  the returned memory, free each returned memory
       pointer; pointers inside the memory  do  not  need  to  be
       individually freed.

       The  <EM>flags</EM> argument is specified by <STRONG>or</STRONG>'ing together one or
       more of the following values:

       DB_ARCH_ABS
            All pathnames are  returned  as  absolute  pathnames,
            instead of relative to the database home directory.

       DB_ARCH_DATA
            Return the database files that need to be archived in
            order to recover the database from catastrophic fail-
            ure.   If  any  of  the  database files have not been
            accessed during  the  lifetime  of  the  current  log
            files,  <EM>log</EM><STRONG>_</STRONG><EM>archive</EM>  will  not  include  them in this
            list.  It is also possible that  some  of  the  files
            referenced  in  the  log have since been deleted from
            the system.

       DB_ARCH_LOG
            Return all the log file names regardless  of  whether
            or not they are in use.


       The DB_ARCH_DATA and DB_ARCH_LOG flags are mutually exclu-
       sive.

       The <EM>log</EM><STRONG>_</STRONG><EM>archive</EM> function returns the  value  of  <EM>errno</EM>  on
       failure and 0 on success.

       The  <EM>log</EM><STRONG>_</STRONG><EM>archive</EM>  function is the underlying function used
       by the <STRONG><A HREF="db_archive.html">db_archive(1)</A></STRONG> utility.  See the source code for the
       <EM>db</EM><STRONG>_</STRONG><EM>archive</EM>  utility for an example of using <EM>log</EM><STRONG>_</STRONG><EM>archive</EM> in
       a UNIX environment.  See the <STRONG><A HREF="db_archive.html">db_archive(1)</A></STRONG> manual page for
       more information on database archival procedures.

  <EM>log</EM><STRONG>_</STRONG><EM>register</EM>
       The  <EM>log</EM><STRONG>_</STRONG><EM>register</EM>  function registers a file name with the
       log manager and copies a file identification  number  into
       the memory location referenced by <EM>fidp</EM>.  This file identi-
       fication number should be used in all subsequent log  mes-

       The <EM>log</EM><STRONG>_</STRONG><EM>register</EM> function returns the value  of  <EM>errno</EM>  on
       failure and 0 on success.

  <EM>log</EM><STRONG>_</STRONG><EM>unregister</EM>
       The <EM>log</EM><STRONG>_</STRONG><EM>unregister</EM> function disassociates the file name to
       file identification number mapping for the file  identifi-
       cation  number  specified  by the <EM>fid</EM> parameter.  The file
       identification number may then be reused.

       The <EM>log</EM><STRONG>_</STRONG><EM>unregister</EM> function returns the value of <EM>errno</EM>  on
       failure and 0 on success.

  <EM>log</EM><STRONG>_</STRONG><EM>stat</EM>
       The  <EM>log</EM><STRONG>_</STRONG><EM>stat</EM> function creates a statistical structure and
       copies a pointer to  it  into  the  user-specified  memory
       location.

       Statistical structure are created in allocated memory.  If
       <EM>db</EM><STRONG>_</STRONG><EM>malloc</EM> is non-NULL, it is called to allocate  the  mem-
       ory,  otherwise,  the  library function <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG> is used.
       The function <EM>db</EM><STRONG>_</STRONG><EM>malloc</EM> must match the calling  conventions
       of  the <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG> library routine.  Regardless, the caller
       is responsible for deallocating the returned  memory.   To
       deallocate  the returned memory, free each returned memory
       pointer; pointers inside the memory  do  not  need  to  be
       individually freed.

       The  log  region  statistics  are stored in a structure of
       type DB_LOG_STAT (typedef'd  in  &lt;db.h&gt;).   The  following
       DB_LOG_STAT fields will be filled in:

       u_int32_t st_magic;
            The  magic  number  that  identifies  a file as a log
            file.
       u_int32_t st_version;
            The version of the log file type.
       int st_mode;
            The mode of any created log files.
       u_int32_t st_lg_max;
            The maximum size of any  individual  file  comprising
            the log.
       u_int32_t st_w_bytes;
            The  number of bytes over and above <EM>st</EM><STRONG>_</STRONG><EM>w</EM><STRONG>_</STRONG><EM>mbytes</EM> writ-
            ten to this log.
       u_int32_t st_w_mbytes;
            The number of megabytes written to this log.
       u_int32_t st_wc_bytes;
            The number of bytes over and above <EM>st</EM><STRONG>_</STRONG><EM>wc</EM><STRONG>_</STRONG><EM>mbytes</EM> writ-
            ten to this log since the last checkpoint.
       u_int32_t st_wc_mbytes;
            The number of megabytes written to this log since the
            last checkpoint.
       u_int32_t st_region_wait;
            using <EM>db</EM><STRONG>_</STRONG><EM>appinit</EM>, the  environment  variable  DB_HOME
            may  be used as the path of the database home for the
            interpretation of the <EM>dir</EM> argument  to  <EM>log</EM><STRONG>_</STRONG><EM>open</EM>,  as
            described  in  <STRONG><A HREF="db_appinit.html">db_appinit(3)</A></STRONG>.  Specifically, <EM>log</EM><STRONG>_</STRONG><EM>open</EM>
            is affected by  the  configuration  string  value  of
            DB_LOG_DIR.

       TMPDIR
            If  the  <EM>dbenv</EM>  argument  to <EM>log</EM><STRONG>_</STRONG><EM>open</EM> was NULL or not
            initialized using <EM>db</EM><STRONG>_</STRONG><EM>appinit</EM>, the  environment  vari-
            able  TMPDIR may be used as the directory in which to
            create the log, as described in the <EM>log</EM><STRONG>_</STRONG><EM>open</EM>  section
            above.

</PRE>
<H2>ERRORS</H2><PRE>
       The <EM>log</EM><STRONG>_</STRONG><EM>open</EM> function may fail and return <EM>errno</EM> for any of
       the errors specified for  the  following  DB  and  library
       functions: <STRONG><A HREF="atoi.html">atoi(3)</A></STRONG>, <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="db_version.html">db_version(3)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>,
       <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="log_close.html">log_close(3)</A></STRONG>, <STRONG><A HREF="log_unlink.html">log_unlink(3)</A></STRONG>, <STRONG><A HREF="lseek.html">lseek(2)</A></STRONG>,
       <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="mmap.html">mmap(2)</A></STRONG>, <STRONG><A HREF="munmap.html">munmap(2)</A></STRONG>,
       <STRONG><A HREF="open.html">open(2)</A></STRONG>, <STRONG><A HREF="opendir.html">opendir(3)</A></STRONG>, <STRONG><A HREF="read.html">read(2)</A></STRONG>, <STRONG><A HREF="readdir.html">readdir(3)</A></STRONG>, <STRONG><A HREF="realloc.html">realloc(3)</A></STRONG>,
       <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>, <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>, <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strchr.html">strchr(3)</A></STRONG>,
       <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>, <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>, <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>, <STRONG><A HREF="strncmp.html">strncmp(3)</A></STRONG>,
       <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>, and <STRONG><A HREF="write.html">write(2)</A></STRONG>.

       In addition, the <EM>log</EM><STRONG>_</STRONG><EM>open</EM> function may fail and return <EM>er-</EM>
       <EM>rno</EM> for the following conditions:

       [EAGAIN]
            The shared memory region was locked and  (repeatedly)
            unavailable.

       [EINVAL]
            An invalid flag value or parameter was specified.

            The  DB_THREAD  flag  was specified and spinlocks are
            not implemented for this architecture.

            The specified file size was too large.

       The <EM>log</EM><STRONG>_</STRONG><EM>close</EM> function may fail and return <EM>errno</EM>  for  any
       of  the  errors specified for the following DB and library
       functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="munmap.html">munmap(2)</A></STRONG>, and
       <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>.

       The  <EM>log</EM><STRONG>_</STRONG><EM>flush</EM>  function may fail and return <EM>errno</EM> for any
       of the errors specified for the following DB  and  library
       functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="fsync.html">fsync(2)</A></STRONG>,
       <STRONG><A HREF="lseek.html">lseek(2)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="open.html">open(2)</A></STRONG>,
       <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>, <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>, <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>,
       <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>, <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>, <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>, and
       <STRONG><A HREF="write.html">write(2)</A></STRONG>.

       In  addition,  the  <EM>log</EM><STRONG>_</STRONG><EM>flush</EM> function may fail and return
       <EM>errno</EM> for the following conditions:


       In  addition, the <EM>log</EM><STRONG>_</STRONG><EM>get</EM> function may fail and return <EM>er-</EM>
       <EM>rno</EM> for the following conditions:

       [EINVAL]
            An invalid flag value or parameter was specified.

            The DB_FIRST flag was specified and no log files were
            found.

       The <EM>log</EM><STRONG>_</STRONG><EM>file</EM> function may fail and return <EM>errno</EM> for any of
       the errors specified for  the  following  DB  and  library
       functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>,
       <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="open.html">open(2)</A></STRONG>, <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>,
       <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>, <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>, <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>,
       <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>, and <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>.

       In addition, the <EM>log</EM><STRONG>_</STRONG><EM>file</EM> function may fail and return <EM>er-</EM>
       <EM>rno</EM> for the following conditions:

       [ENOMEM]
            The  supplied  buffer  was  too small to hold the log
            file name.

       The <EM>log</EM><STRONG>_</STRONG><EM>put</EM> function may fail and return <EM>errno</EM> for any  of
       the  errors  specified  for  the  following DB and library
       functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="fsync.html">fsync(2)</A></STRONG>,
       <STRONG><A HREF="lseek.html">lseek(2)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="open.html">open(2)</A></STRONG>,
       <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>, <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>, <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>,
       <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>, <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>, <STRONG><A HREF="time.html">time(3)</A></STRONG>, <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>, and
       <STRONG><A HREF="write.html">write(2)</A></STRONG>.

       In addition, the <EM>log</EM><STRONG>_</STRONG><EM>put</EM> function may fail and return  <EM>er-</EM>
       <EM>rno</EM> for the following conditions:

       [EINVAL]
            An invalid flag value or parameter was specified.

            The  record  to  be logged is larger than the maximum
            log record.

       The <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM> function may fail and return <EM>errno</EM> for  any
       of  the  errors specified for the following DB and library
       functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>,
       <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="mmap.html">mmap(2)</A></STRONG>, <STRONG><A HREF="munmap.html">munmap(2)</A></STRONG>, <STRONG><A HREF="open.html">open(2)</A></STRONG>,
       <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>, <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>, <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>,
       <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>, <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>, and <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>.

       In  addition,  the <EM>log</EM><STRONG>_</STRONG><EM>unlink</EM> function may fail and return
       <EM>errno</EM> for the following conditions:

       [EBUSY]
            The shared memory region was in  use  and  the  force

       In addition, the <EM>log</EM><STRONG>_</STRONG><EM>archive</EM> function may fail and  return
       <EM>errno</EM> for the following conditions:

       [EINVAL]
            An invalid flag value or parameter was specified.

            The log was corrupted.

       The  <EM>log</EM><STRONG>_</STRONG><EM>register</EM>  function  may fail and return <EM>errno</EM> for
       any of the errors specified for the following DB  and  li-
       brary functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="fsync.html">fsync(2)</A></STRONG>,
       <STRONG><A HREF="lseek.html">lseek(2)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcmp.html">memcmp(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>,
       <STRONG><A HREF="open.html">open(2)</A></STRONG>, <STRONG><A HREF="realloc.html">realloc(3)</A></STRONG>, <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>, <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>,
       <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>, <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>, <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>,
       <STRONG><A HREF="time.html">time(3)</A></STRONG>, <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>, and <STRONG><A HREF="write.html">write(2)</A></STRONG>.

       In addition, the <EM>log</EM><STRONG>_</STRONG><EM>register</EM> function may fail and return
       <EM>errno</EM> for the following conditions:

       [EINVAL]
            An invalid flag value or parameter was specified.

       The <EM>log</EM><STRONG>_</STRONG><EM>unregister</EM> function may fail and return <EM>errno</EM>  for
       any  of  the errors specified for the following DB and li-
       brary functions: <STRONG><A HREF="close.html">close(2)</A></STRONG>, <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, <STRONG><A HREF="fflush.html">fflush(3)</A></STRONG>, <STRONG><A HREF="fsync.html">fsync(2)</A></STRONG>,
       <STRONG><A HREF="lseek.html">lseek(2)</A></STRONG>, <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>, <STRONG><A HREF="memcpy.html">memcpy(3)</A></STRONG>, <STRONG><A HREF="memset.html">memset(3)</A></STRONG>, <STRONG><A HREF="open.html">open(2)</A></STRONG>,
       <STRONG><A HREF="sigfillset.html">sigfillset(3)</A></STRONG>, <STRONG><A HREF="sigprocmask.html">sigprocmask(2)</A></STRONG>, <STRONG><A HREF="stat.html">stat(2)</A></STRONG>, <STRONG><A HREF="strcpy.html">strcpy(3)</A></STRONG>,
       <STRONG><A HREF="strdup.html">strdup(3)</A></STRONG>, <STRONG><A HREF="strerror.html">strerror(3)</A></STRONG>, <STRONG><A HREF="strlen.html">strlen(3)</A></STRONG>, <STRONG><A HREF="time.html">time(3)</A></STRONG>, <STRONG><A HREF="unlink.html">unlink(2)</A></STRONG>, and
       <STRONG><A HREF="write.html">write(2)</A></STRONG>.

       In addition, the <EM>log</EM><STRONG>_</STRONG><EM>unregister</EM> function may fail and  re-
       turn <EM>errno</EM> for the following conditions:

       [EINVAL]
            An invalid flag value or parameter was specified.

       The <EM>log</EM><STRONG>_</STRONG><EM>stat</EM> function may fail and return <EM>errno</EM> for any of
       the errors specified for  the  following  DB  and  library
       functions: <STRONG><A HREF="fcntl.html">fcntl(2)</A></STRONG>, and <STRONG><A HREF="malloc.html">malloc(3)</A></STRONG>.


</PRE>
<H2>BUGS</H2><PRE>
       The  log  files  are not machine architecture independent.
       Specifically, log file metadata is not stored in  a  fixed
       byte order.


</PRE>
<H2>SEE ALSO</H2><PRE>
       <STRONG><A HREF="db_archive.html">db_archive(1)</A></STRONG>, <STRONG><A HREF="db_checkpoint.html">db_checkpoint(1)</A></STRONG>, <STRONG><A HREF="db_deadlock.html">db_deadlock(1)</A></STRONG>, <STRONG><A HREF="db_dump.html">db_dump(1)</A></STRONG>,
       <STRONG><A HREF="db_load.html">db_load(1)</A></STRONG>, <STRONG><A HREF="db_recover.html">db_recover(1)</A></STRONG>, <STRONG><A HREF="db_stat.html">db_stat(1)</A></STRONG>, <STRONG><A HREF="db_intro.html">db_intro(3)</A></STRONG>,
       <STRONG><A HREF="db_appinit.html">db_appinit(3)</A></STRONG>, <STRONG><A HREF="db_cursor.html">db_cursor(3)</A></STRONG>, <STRONG><A HREF="db_dbm.html">db_dbm(3)</A></STRONG>, <STRONG><A HREF="db_jump.html">db_jump(3)</A></STRONG>, <STRONG><A HREF="db_lock.html">db_lock(3)</A></STRONG>,
       <STRONG><A HREF="db_log.html">db_log(3)</A></STRONG>, <STRONG><A HREF="db_mpool.html">db_mpool(3)</A></STRONG>, <STRONG><A HREF="db_open.html">db_open(3)</A></STRONG>, <STRONG><A HREF="db_thread.html">db_thread(3)</A></STRONG>, <STRONG><A HREF="db_txn.html">db_txn(3)</A></STRONG>
</PRE>
</BODY>
</HTML>
